# needs at least 16 GB of memory

exp_name: test_if_work_3
work_dir: /home/day3/cxx/codefield/MyBasicVSR/work_dir

train_dataloader:
  batch_size: 4
  shuffle: True
  num_workers: 0
  pin_memory: True
  dataset:
    type: REDSDataset
    gt_dir: /home/day3/cxx/codefield/MyBasicVSR/data/REDS/train_sharp
    lq_dir: /home/day3/cxx/codefield/MyBasicVSR/data/REDS/train_sharp_bicubic/X4
    scale_factor: 4
    patch_size: 64
    num_input_frames: 15
    filename_tmpl: "{:08d}.png"
    max_keys: 270
    val_partition: REDS4
    is_test: False

val_dataloader:
  batch_size: 1
  shuffle: False
  num_workers: 0
  pin_memory: True
  dataset:
    type: REDSDataset
    gt_dir: /home/day3/cxx/codefield/MyBasicVSR/data/REDS/train_sharp
    lq_dir: /home/day3/cxx/codefield/MyBasicVSR/data/REDS/train_sharp_bicubic/X4
    scale_factor: 4
    patch_size: 64
    num_input_frames: 100
    filename_tmpl: "{:08d}.png"
    max_keys: 270
    val_partition: REDS4
    is_test: True

model:

opt:
  batch_size: 2
  n_workers: 32
  n_itrs: 50000

  optim_type: adam
  lr: 1.e-4
  weight_decay: 0.0
  beta1: 0.9
  beta2: 0.999

  clip_grad_norm: 1.0

  sched_type: step
  milestones: [-1]
  gamma: 0.1

  mse: 1
  beta: 1.e-4 # 0
  tv: 0 # 0.1

